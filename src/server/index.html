<!doctype html>
<html>
  <head>
    <title>Crowdsourced Gameboy Advanced</title>
    <meta charset="utf-8" />
    <script type="text/javascript" src="http://code.jquery.com/jquery.min.js"></script>
    <link href="https://www.bootstrapcdn.com/twitter-bootstrap/2.3.1/css/bootstrap-combined.no-icons.min.css" rel="stylesheet">
    <script>
    //grab the local host
    var host = window.location.host;
    //create the WebSocket
    var ws = new WebSocket('ws://'+host+'/ws');

    // log the response
    log = function(data){
      $("div#terminal").prepend("</br>" +data);
      console.log(data);
    };

    $(document).ready(function () {
        var $status = $('#status');

        // Handle incoming websocket message callback
        ws.onmessage = function(evt) {
          $status.attr("class", 'label label-info');
          $status.hide();
          $status.fadeIn("slow");
          $status.text('recieved message');
          log("Message Received: " + evt.data)
          alert("message received: " + evt.data);
          };

        ws.onclose = function(evt) {
          $status.attr("class", 'label label-important');
          $status.text('closed');
          };

        // Open Websocket callback update the status to be open
        ws.onopen = function(evt) {
          $("div#message_details").show();
          $status.attr("class", 'label label-success');
          $status.text('open');
        };

      // Send websocket message function
      $("#send").click(function(evt) {
          log("Sending Message: "+$("#message").val());
          ws.send($("#message").val());
      });

    });
    </script>
    </head>

    <body>
      <h1>Crowdsourced Gameboy Advanced</h1>
      <div class="container">
        <hr>
          WebSocket status : <span id="status"></span>
        <hr>
          </br></br>
          <label for="message">message:</label>
          <input type="text" id="message" value="Hello World!"/><br />
          <input type="submit" id="send" value="send" />
        </div>
      <div id="terminal">

      </div>
    </body>
  </html>
